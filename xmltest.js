const xml = `<INVENTORY>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>1722-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>2151-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>2152-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>2154-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>2161-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>3438-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>2</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>3442-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6107-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6110-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6256-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6285-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6491-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6496-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6544-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6673-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6783-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6809-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6815-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6834-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6854-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6856-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6877-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>3</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6887-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6899-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6923-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6925-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6949-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6979-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>6990-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8032-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8074-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8222-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>2</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8225-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>2</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8226-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8422-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8448-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8458-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>8856-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>9732-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>C</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>9747-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>2</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>9748-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
	<ITEM>
		<ITEMTYPE>S</ITEMTYPE>
		<ITEMID>1666-1</ITEMID>
		<COLOR>0</COLOR>
		<QTY>1</QTY>
		<CONDITION>U</CONDITION>
		<SUBCONDITION>I</SUBCONDITION>
	</ITEM>
</INVENTORY>`;

function parseXml() {

  let document = XmlService.parse(xml);
  let root = document.getRootElement();

  let items = root.getChildren('ITEM');
  Logger.log(items.length)

  let stagingsheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName(BrickApp.sheets.STAGING);
  let idx = stagingsheet.getLastRow();

  const ssVals = [];
  for (item of items) {
    if (item.getChild(`ITEMTYPE`).getText() == `S`) {
      const num = item.getChild(`ITEMID`).getText();
      const qty = item.getChild(`QTY`).getText();
      ssVals.push([`${idx}`,`=IMAGE("https://img.bricklink.com/ItemImage/SN/0/${num}.png")`, `${num}`, `${qty}`, 'false']);
      idx++
    }
  }

  Logger.log(ssVals);


  LockService.getScriptLock().waitLock(60000);
  stagingsheet.getRange(stagingsheet.getLastRow() + 1, 1, ssVals.length, ssVals[0].length).setValues(ssVals);
}
